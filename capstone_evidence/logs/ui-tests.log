
[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mC:/Users/arche/Desktop/BharatVote/frontend[39m

 [32mâœ“[39m src/utils/publicResultsEvents.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 22[2mms[22m[39m
 [32mâœ“[39m src/components/PrimaryButton.test.tsx [2m([22m[2m8 tests[22m[2m)[22m[33m 331[2mms[22m[39m
[90mstdout[2m | src/test/AdminRoot.test.tsx[2m > [22m[2mAdmin merkle root helpers[2m > [22m[2mfetches merkle root and calls setMerkleRoot
[22m[39mDEBUG: Attempting to fetch candidates...
DEBUG: Contract address: [90mundefined[39m

[90mstdout[2m | src/test/AdminRoot.test.tsx[2m > [22m[2mAdmin merkle root helpers[2m > [22m[2mfetches merkle root and calls setMerkleRoot
[22m[39mDEBUG: Raw candidates from contract: []
DEBUG: Mapped candidates: []

 [32mâœ“[39m src/test/AdminRoot.test.tsx [2m([22m[2m1 test[22m[2m)[22m[33m 460[2mms[22m[39m
   [33m[2mâœ“[22m[39m Admin merkle root helpers[2m > [22mfetches merkle root and calls setMerkleRoot [33m 455[2mms[22m[39m
[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful KYC validation
[22m[39mDEBUG KYC: Starting KYC validation for voter: VOTER1
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful KYC validation
[22m[39mDEBUG KYC: Backend response status: [33m200[39m

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful KYC validation
[22m[39mDEBUG KYC: Backend response data: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
KYC Validation Details:
- Voter ID: VOTER1
- Expected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Connected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Addresses Match: [33mtrue[39m
DEBUG KYC: KYC Validation successful: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
DEBUG KYC: Showing OTP modal

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles KYC validation failure for invalid voter ID
[22m[39mDEBUG KYC: Starting KYC validation for voter: INVALID_VOTER
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles KYC validation failure for invalid voter ID
[22m[39mDEBUG KYC: Backend response status: [33m200[39m

stderr | src/KycPage.test.tsx > KycPage > handles KYC validation failure for invalid voter ID
DEBUG KYC: KYC validation error: Error: Voter ID not found in electoral rolls. Please check your Voter ID.
    at handleSendOtp (C:\Users\arche\Desktop\BharatVote\frontend\src\KycPage.tsx:72:15)

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles KYC validation failure for invalid voter ID
[22m[39mDEBUG KYC: Backend response data: { eligible: [33mfalse[39m }

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles address mismatch error
[22m[39mDEBUG KYC: Starting KYC validation for voter: VOTER2
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles address mismatch error
[22m[39mDEBUG KYC: Backend response status: [33m200[39m

stderr | src/KycPage.test.tsx > KycPage > handles address mismatch error
DEBUG KYC: KYC validation error: Error: You are not eligible to vote with this wallet. Please ensure you are using the correct voter credentials and wallet.
    at handleSendOtp (C:\Users\arche\Desktop\BharatVote\frontend\src\KycPage.tsx:90:15)

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles address mismatch error
[22m[39mDEBUG KYC: Backend response data: {
  eligible: [33mtrue[39m,
  address: [32m'0x1234567890123456789012345678901234567890'[39m
}
KYC Validation Details:
- Voter ID: VOTER2
- Expected Address: 0x1234567890123456789012345678901234567890
- Connected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Addresses Match: [33mfalse[39m

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mshows OTP modal after successful KYC
[22m[39mDEBUG KYC: Starting KYC validation for voter: VOTER1
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mshows OTP modal after successful KYC
[22m[39mDEBUG KYC: Backend response status: [33m200[39m

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mshows OTP modal after successful KYC
[22m[39mDEBUG KYC: Backend response data: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
KYC Validation Details:
- Voter ID: VOTER1
- Expected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Connected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Addresses Match: [33mtrue[39m
DEBUG KYC: KYC Validation successful: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
DEBUG KYC: Showing OTP modal

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles OTP input correctly
[22m[39mDEBUG KYC: Starting KYC validation for voter: VOTER1
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles OTP input correctly
[22m[39mDEBUG KYC: Backend response status: [33m200[39m

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles OTP input correctly
[22m[39mDEBUG KYC: Backend response data: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
KYC Validation Details:
- Voter ID: VOTER1
- Expected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Connected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Addresses Match: [33mtrue[39m
DEBUG KYC: KYC Validation successful: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
DEBUG KYC: Showing OTP modal

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful OTP verification
[22m[39mDEBUG KYC: Starting KYC validation for voter: VOTER1
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful OTP verification
[22m[39mDEBUG KYC: Backend response status: [33m200[39m

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful OTP verification
[22m[39mDEBUG KYC: Backend response data: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
KYC Validation Details:
- Voter ID: VOTER1
- Expected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Connected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Addresses Match: [33mtrue[39m
DEBUG KYC: KYC Validation successful: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
DEBUG KYC: Showing OTP modal

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful OTP verification
[22m[39mDEBUG KYC: OTP submit button clicked
DEBUG KYC: Entered OTP: 123456
DEBUG KYC: OTP length: [33m6[39m
DEBUG KYC: Voter ID: VOTER1
DEBUG KYC: Expected OTP: 123456
DEBUG KYC: OTP match: [33mtrue[39m
DEBUG KYC: OTP verified successfully, showing face verification
DEBUG FaceRecognition: Component mounted
DEBUG FaceRecognition: isTestEnv: [33mtrue[39m
DEBUG FaceRecognition: Main useEffect triggered
DEBUG FaceRecognition: Test environment detected, auto-verifying

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful OTP verification
[22m[39mDEBUG KYC: Face verification completed, calling onVerified

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles successful OTP verification
[22m[39mDEBUG KYC: Calling onVerified with voterId: VOTER1

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles incorrect OTP
[22m[39mDEBUG KYC: Starting KYC validation for voter: VOTER1
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles incorrect OTP
[22m[39mDEBUG KYC: Backend response status: [33m200[39m

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles incorrect OTP
[22m[39mDEBUG KYC: Backend response data: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
KYC Validation Details:
- Voter ID: VOTER1
- Expected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Connected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Addresses Match: [33mtrue[39m
DEBUG KYC: KYC Validation successful: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
DEBUG KYC: Showing OTP modal

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles incorrect OTP
[22m[39mDEBUG KYC: OTP submit button clicked
DEBUG KYC: Entered OTP: 999999
DEBUG KYC: OTP length: [33m6[39m
DEBUG KYC: Voter ID: VOTER1
DEBUG KYC: Expected OTP: 123456
DEBUG KYC: OTP match: [33mfalse[39m
DEBUG KYC: OTP verification failed

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mshows loading state during KYC validation
[22m[39mDEBUG KYC: Starting KYC validation for voter: VOTER1
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles network errors gracefully
[22m[39mDEBUG KYC: Backend response status: [33m200[39m

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles network errors gracefully
[22m[39mDEBUG KYC: Backend response data: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
KYC Validation Details:
- Voter ID: VOTER1
- Expected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Connected Address: 0x01bad59740664445fd489315e14f4300639c253b
- Addresses Match: [33mtrue[39m
DEBUG KYC: KYC Validation successful: {
  eligible: [33mtrue[39m,
  address: [32m'0x01bad59740664445Fd489315E14F4300639c253b'[39m
}
DEBUG KYC: Showing OTP modal

[90mstdout[2m | src/KycPage.test.tsx[2m > [22m[2mKycPage[2m > [22m[2mhandles network errors gracefully
[22m[39mDEBUG KYC: Starting KYC validation for voter: VOTER1
DEBUG KYC: Backend URL: http://localhost:3001
DEBUG KYC: Account: 0x01bad59740664445Fd489315E14F4300639c253b

stderr | src/KycPage.test.tsx > KycPage > handles network errors gracefully
DEBUG KYC: KYC validation error: Error: Network error
    at C:\Users\arche\Desktop\BharatVote\frontend\src\KycPage.test.tsx:303:47
    at file:///C:/Users/arche/Desktop/BharatVote/frontend/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:155:11
    at file:///C:/Users/arche/Desktop/BharatVote/frontend/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:752:26
    at file:///C:/Users/arche/Desktop/BharatVote/frontend/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:1897:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///C:/Users/arche/Desktop/BharatVote/frontend/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:1863:10)
    at runTest (file:///C:/Users/arche/Desktop/BharatVote/frontend/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:1574:12)
    at runSuite (file:///C:/Users/arche/Desktop/BharatVote/frontend/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runSuite (file:///C:/Users/arche/Desktop/BharatVote/frontend/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:1729:8)
    at runFiles (file:///C:/Users/arche/Desktop/BharatVote/frontend/node_modules/.pnpm/@vitest+runner@3.2.4/node_modules/@vitest/runner/dist/chunk-hooks.js:1787:3)

 [32mâœ“[39m src/KycPage.test.tsx [2m([22m[2m13 tests[22m[2m)[22m[33m 5020[2mms[22m[39m
   [33m[2mâœ“[22m[39m KycPage[2m > [22mhandles KYC validation failure for invalid voter ID [33m 356[2mms[22m[39m
   [33m[2mâœ“[22m[39m KycPage[2m > [22mhandles successful OTP verification [33m 2304[2mms[22m[39m
   [33m[2mâœ“[22m[39m KycPage[2m > [22mhandles incorrect OTP [33m 685[2mms[22m[39m

[2m Test Files [22m [1m[32m4 passed[39m[22m[90m (4)[39m
[2m      Tests [22m [1m[32m25 passed[39m[22m[90m (25)[39m
[2m   Start at [22m 16:52:22
[2m   Duration [22m 10.90s[2m (transform 800ms, setup 6.05s, collect 2.92s, tests 5.83s, environment 4.97s, prepare 1.62s)[22m

