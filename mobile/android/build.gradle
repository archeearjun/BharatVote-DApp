// android/build.gradle  (project-level)

buildscript {
  ext {
    // SDK / tools versions
    minSdkVersion     = 21
    compileSdkVersion = 35
    targetSdkVersion  = 35
    ndkVersion        = "25.1.8937393"

    // Kotlin for RN 0.73.x
    kotlinVersion = "1.9.24"
  }

  repositories {
    google()
    mavenCentral()
  }

  dependencies {
    // AGP 8.11.x pairs fine with Gradle 8.13; you already have Build-Tools 35 installed.
    classpath "com.android.tools.build:gradle:8.11.1"

    // React Native Gradle plugin (version is resolved via your node_modules)
    classpath "com.facebook.react:react-native-gradle-plugin"

    // Kotlin
    classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:${kotlinVersion}"
  }
}

apply plugin: "com.facebook.react.rootproject"

// Optional: repositories fallback for all modules (usually not required if each module defines its own)
allprojects {
  repositories {
    google()
    mavenCentral()
  }
}

/**
 * Global compilation settings
 * - Java 17 compatibility for Java sources
 * - Strip Kotlin '-Werror' everywhere (including :gradle-plugin)
 */
allprojects {
  // Java 17
  tasks.withType(JavaCompile).configureEach {
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
  }

  // Kotlin: disable warnings-as-errors everywhere
  tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinCompile).configureEach {
    kotlinOptions {
      // Don't fail on warnings
      allWarningsAsErrors = false

      // Ensure common args are present
      freeCompilerArgs += [
        "-Xjsr305=strict",
        "-Xjvm-default=all"
      ]
      // Remove -Werror if it exists
      freeCompilerArgs.removeAll { it == "-Werror" }

      jvmTarget = "17"
    }
  }
}
